- name: Copying Mysql repo
  ansible.builtin.copy:
    src: "{{COMPONENT}}.repo"
    dest: /etc/yum.repos.d/{{COMPONENT}}.repo

- name: Installing MySql
  ansible.builtin.yum
    name: 
      - mysql-community-server
      - MySQL-python
    state: present

- name: Starting MySQL service
  ansible.builtin.service:
    name: mysqld
    state: started
    enabled: true

- name: Collect all info except settings and users by root
  community.mysql.mysql_info:
    login_user: root
    login_password: RoboShop@1
  ignore_errors: yes                              #result is ignored and proceed with next action
  register: MYSQL_STAT

- name: Reset Password
  when : MYSQL_STAT.failed             #This task will be executed only when the status of failed is true
  ansible.builtin.shell: grep "temporary password" /var/log/mysqld.log | awk '{print $NF}'
  register: DEFAULT_ROOT_PASSWORD




    
